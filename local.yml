- hosts: localhost
  become: true
  module_defaults:
    apt:
      force_apt_get: yes
  vars:
    tf_version: 0.12.14
    tf_sha256: 8db6b396eb2626f18bf5e98af824645bb96d8290e2ab761b2dace3a2574b8cee
    jb_version: 1.16.6067
    jb_sha256: 3b9c6cd630e602c845c3f716f735f9748fc2086986f45fbdf6a555484e95c45e
    dropbox_version: 2019.02.14
    node_version: 10.x
  tasks:
    - name: 'Install packages'
      apt:
        pkg:
          - htop
          - unzip
          - git
    - name: Go
      snap:
        name: go
        classic: yes
        channel: latest/stable
    - name: 'Download Terraform {{ tf_version }}'
      get_url:
        url: https://releases.hashicorp.com/terraform/{{ tf_version }}/terraform_{{ tf_version }}_linux_amd64.zip
        dest: /tmp/terraform_{{ tf_version }}_linux_amd64.zip
        checksum: sha256:'{{ tf_sha256 }}'
    - name: 'Extract Terraform {{ tf_version }}'
      unarchive:
        src: /tmp/terraform_{{ tf_version }}_linux_amd64.zip
        dest: /usr/local/bin
    - name: 'Download JetBrains Toolbox {{ jb_version }}'
      get_url:
        url: https://download.jetbrains.com/toolbox/jetbrains-toolbox-{{ jb_version }}.tar.gz
        dest: /tmp/jetbrains-toolbox-{{ jb_version }}.tar.gz
        checksum: sha256:'{{ jb_sha256 }}'
    - name: 'Extract JetBrains Toolbox {{ jb_version }}'
      unarchive:
        src: /tmp/jetbrains-toolbox-{{ jb_version }}.tar.gz
        dest: /tmp
    - name: 'Install JetBrains Toolbox {{ jb_version }}'
      command:
        cmd: /tmp/jetbrains-toolbox-{{ jb_version }}/jetbrains-toolbox
        creates: ~/.local/share/JetBrains/Toolbox/bin/jetbrains-toolbox
    - name: 'Install Dropbox'
      apt:
        deb: https://linux.dropbox.com/packages/ubuntu/dropbox_{{ dropbox_version }}_amd64.deb

    - name: 'Add NodeSource Key'
      apt_key: 
        url: https://deb.nodesource.com/gpgkey/nodesource.gpg.key
    - name: 'Add NodeSource Repository'
      apt_repository:
        repo: 'deb https://deb.nodesource.com/node_{{ node_version }} {{ ansible_distribution_release }} main' 
        update_cache: yes
    - name: 'Install NodeJS'
      apt:
        name: nodejs